# Прогнозирование стоимости автомобиля

## Описание проекта

Сервис по продаже автомобилей с пробегом «Не бит, не крашен» разрабатывает приложение, чтобы привлечь новых клиентов. В нём можно будет узнать рыночную стоимость своего автомобиля. 
Постройте модель, которая умеет её определять. В вашем распоряжении данные о технических характеристиках, комплектации и ценах других автомобилей.
Критерии, которые важны заказчику:
* качество предсказания;
* время обучения модели;
* время предсказания модели.

**Набор данных**
* DateCrawled — дата скачивания анкеты из базы
* VehicleType — тип автомобильного кузова
* RegistrationYear — год регистрации автомобиля
* Gearbox — тип коробки передач
* Power — мощность (л. с.)
* Model — модель автомобиля
* Kilometer — пробег (км)
* RegistrationMonth — месяц регистрации автомобиля
* FuelType — тип топлива
* Brand — марка автомобиля
* Repaired — была машина в ремонте или нет
* DateCreated — дата создания анкеты
* NumberOfPictures — количество фотографий автомобиля
* PostalCode — почтовый индекс владельца анкеты (пользователя)
* LastSeen — дата последней активности пользователя

Целевой признак
* Price — цена (евро)

**Цель исследования** 
* Сравнить характеристики моделей: время обучения, время предсказания, точность результата.
* Для оценки качества моделей применить метрику RMSE.
* Значение метрики RMSE должно быть меньше 2500.
* Найти лучшую модель для предсказания стоимости автомобиля.

**Ход исследования**
* Изучить данные. Заполнить пропущенные значения и обработайть аномалии в столбцах. Если среди признаков имеются неинформативные, удалить их.
* Подготовить выборки для обучения моделей.
* Обучить разные модели, одна из которых — LightGBM, как минимум одна — не бустинг. Для каждой модели попробовать разные гиперпараметры.
* Проанализировать время обучения, время предсказания и качество моделей.
* Опираясь на критерии заказчика, выберать лучшую модель, проверить её качество на тестовой выборке.

## Инструменты
* CatBoost
* LightGBM
* Matplotlib
* Numpy
* Pandas
* Scikit learn
* Scipy

## Выводы

0. Без изменений 
    
    CBR: 1751.25, LGBM: 1759.26

1. Оставим колонку "LastSeen"
    
    CBR: 1768.6672519195145 LGBM: 1910.2566088926299 **(Ухудшилось)**

2. Оставим колонку "NumberOfPictures"
    
    CBR: 1751.0212125359149 LGBM: 1884.7276016923931 **(Улучшилось)**

3. Удалить нулевые цены
    
    CBR: 1653.9383951268403 LGBM: 1797.2936307281623 **(Улучшилось)**

4. Заполнить VehicleType на основаниии model
    
    CBR: 1653.0751267642183 LGBM: 1786.3050375420669 **(Улучшилось)**

5. Заполнить Gearbox на основании Model
    
    CBR: 1666.0489168085912 LGBM: 1803.6498243872588 **(Ухудшилось)**

6. Заполнить Model на основании VehicleType
    
    **CBR: 1640.3708258797622 LGBM: 1781.0418987336561 (ЛУЧШИЙ ВАРИАНТ)**

7. Заполнить FuelType на основании Model
    
    CBR: 1648.573346866863 LGBM: 1787.6088150227217 **(Ухудшилось)**

**После изменения Pipeline показатели стали следущими:**

* CBR: 1651.488832426201 
* LGBM: 1656.5083759415534

Показатели CatBoost стали хуже, а LightGBM улучшился, но так и не достигли показателей, которые были до изменения Pipeline у CatBoost.

### Финальный результат

* CBR  RMSE: 1655.43
* LGBM RMSE: 1663.86

* CBR  fitting time: 6.61 s
* LGBM fitting time: 8.45 s

* CBR  predict time: 095 ms
* LGBM predict time: 922 m

CatBoost Regressor показал лучший результат по всем показателям. Эта модель лучше всего подходит для решения данной задачи.