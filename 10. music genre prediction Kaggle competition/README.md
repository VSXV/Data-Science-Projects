# Аналитика музыкальных предпочтений

## Описание проекта

**Набор данных**
* train.csv - информация (~20000) музыкальных треках, которые будут использоваться в качестве обучающих данных.
* test.csv - информация (~5000) музыкальных треках, которые будут использоваться в качестве тестовых данных. Ваша задача - предсказать значение * 'music_genre' для каждого трека из этого датасета.
* sample_submit.csv - файл предсказаний в правильном формате.
* instance_id - идентификатор трека в тестовом наборе.
* music_genre - Целевой признак. Для каждого трека предскажите категориальное значение соответствующее музыкальному жанру трека.

**Цель исследования** 

Музыкальный сервис расширяет работу с новыми артистами и музыкантами, в связи с чем возникла задача -- правильно классифицировать новые музыкальные треки, чтобы улучшить работу рекомендательной системы. Наши коллеги из отдела работы со звуком подготовили датасет, в котором собраны некоторые характеристики музыкальных произведений и их жанры. Наша задача -- разработать модель, позволяющую классифицировать музыкальные произведения по жанрам.

**Ход исследования**
- Предварительная обработка
- Полноценный разведочный анализ
- Разработка новых синтетических признаков
- Проверка на мультиколлинеарность
- Отбор финального набора обучающих признаков
- Выбор и обучение моделей
- Итоговая оценка качества предсказания лучшей модели

## Инструменты
- Matplotlib
- Numpy
- Pandas
- Phik
    - Plot correlation matrix
- Seaborn
- Catboost
- Sklearn
    - Random forest classifier
    - Logistic regression
    - MLP classifier
    - Column transformer
    - Iterative imputer
    - Simple imputer
    - F1 score
    - Pipeline
    - Ordinal encoder
    - Robust scaler
    - Polynomial features
- Feature engine
    - Drop constant features
    - Drop correlated features
- Imblearn
    - Pipeline

## Выводы

Заметна высокая корреляция между показателями:
- music_genre - acousticness
- music_genre - dancebility
- music_genre - energy
- music_genre - instrumentalness
- music_genre - loudness
- loudness - acousticness
- loudness - energy
- energy - acousticness

В данной работе были протестированы следующие действия:
- Разработка новых синтетических признаков приводит к снижению f1-меры на 0.01 - 0.02 единицы. Поэтому в дальнейшем будем использовать только исходные признаки.
- Удален duration ниже 0
- Созданы агрегирующие фичи
- Удалены строки с наименьшей корреляцией с целевым признаком
- Удалены строки с наибольшей корреляцией с целевым признаком


Ничего из этого не повлеяло положительно не результаты предсказаний

Модель catboost показала лучший результат
Показатели F1 Micro для моделей с лучшими параметрами на Kaggle.
- CatBoostClassifier: 0.496
- LogisticRegression: 0.454
- RandomForestClassifier: 0.457
- MLPClassifier: 0.461